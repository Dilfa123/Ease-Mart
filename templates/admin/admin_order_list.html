{% extends 'admin/dashboard.html' %}
{% load static %}

{% block content %}

<h1 class="text-2xl font-bold mb-6">ðŸ“¦ Orders</h1>

<div class="bg-white shadow rounded-xl overflow-x-auto">
  <table class="w-full border-collapse">
    <thead class="bg-gray-100 text-left text-sm uppercase text-gray-600">
      <tr>
        <th class="p-4">Order ID</th>
        <th class="p-4">User</th>
        <th class="p-4">Total Amount</th>
        <th class="p-4">Status</th>
        <th class="p-4 text-center">Details</th>
      </tr>
    </thead>

    <tbody class="text-sm">
      {% for order in orders %}
      <tr class="border-t hover:bg-gray-50">

        <td class="p-4 font-semibold">#{{ order.id }}</td>

        <td class="p-4">{{ order.user.username }}</td>

        <td class="p-4 font-bold text-gray-800">
          â‚¹{{ order.total_amount }}
        </td>

        <!-- STATUS DROPDOWN WITH COLORS -->
        <td class="p-4">
          <form method="post"
                action="{% url 'admin_status_change' order.id %}">
            {% csrf_token %}

            <select name="status"
              onchange="this.form.submit()"
              class="w-full px-3 py-1 text-sm font-semibold rounded-lg border
              {% if order.status == 'placed' %}
                bg-blue-100 text-blue-800 border-blue-300
              {% elif order.status == 'confirmed' %}
                bg-indigo-100 text-indigo-800 border-indigo-300
              {% elif order.status == 'packed' %}
                bg-yellow-100 text-yellow-800 border-yellow-300
              {% elif order.status == 'shipped' %}
                bg-purple-100 text-purple-800 border-purple-300
              {% elif order.status == 'delivered' %}
                bg-green-100 text-green-800 border-green-300
              {% elif order.status == 'cancelled' %}
                bg-red-100 text-red-800 border-red-300
              {% endif %}
              focus:outline-none">

              {% for key, label in order.STATUS_CHOICES %}
                <option value="{{ key }}"
                        {% if order.status == key %}selected{% endif %}>
                  {{ label }}
                </option>
              {% endfor %}
            </select>
          </form>
        </td>

        <!-- VIEW DETAILS -->
        <td class="p-4 text-center">
          <a href="{% url 'admin_order_list_detail' order.id %}"
             class="inline-flex items-center px-4 py-2 bg-primary text-white text-xs font-bold rounded-lg hover:bg-primary/90">
            View
          </a>
        </td>

      </tr>
      {% empty %}
      <tr>
        <td colspan="5" class="p-6 text-center text-gray-500">
          No orders found.
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
